<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ollama é€£æ¥æ¸¬è©¦</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .success { color: green; }
        .error { color: red; }
        button { padding: 10px 20px; margin: 5px; }
        #output { white-space: pre-wrap; background: #f5f5f5; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ğŸ” Ollama é€£æ¥æ¸¬è©¦</h1>
    
    <div class="test-section">
        <h3>1. æª¢æŸ¥ Ollama æœå‹™ç‹€æ…‹</h3>
        <button onclick="checkOllamaStatus()">æª¢æŸ¥æœå‹™ç‹€æ…‹</button>
        <div id="status-output"></div>
    </div>
    
    <div class="test-section">
        <h3>2. æª¢æŸ¥å¯ç”¨æ¨¡å‹</h3>
        <button onclick="checkModels()">æª¢æŸ¥æ¨¡å‹åˆ—è¡¨</button>
        <div id="models-output"></div>
    </div>
    
    <div class="test-section">
        <h3>3. æ¸¬è©¦ç°¡å–®å°è©±</h3>
        <button onclick="testSimpleChat()">æ¸¬è©¦å°è©±</button>
        <div id="chat-output"></div>
    </div>
    
    <div class="test-section">
        <h3>4. è©³ç´°æ—¥èªŒ</h3>
        <div id="output"></div>
    </div>

    <script>
        const OLLAMA_URL = 'https://ollama-ai-travel.onrender.com';
        
        function log(message) {
            const output = document.getElementById('output');
            const timestamp = new Date().toLocaleTimeString();
            output.textContent += `[${timestamp}] ${message}\n`;
            console.log(message);
        }
        
        async function checkOllamaStatus() {
            log('ğŸ” æª¢æŸ¥ Ollama æœå‹™ç‹€æ…‹...');
            const output = document.getElementById('status-output');
            
            try {
                const response = await fetch(`${OLLAMA_URL}/api/tags`);
                log(`âœ… æœå‹™éŸ¿æ‡‰: ${response.status} ${response.statusText}`);
                
                if (response.ok) {
                    const data = await response.json();
                    output.innerHTML = `<span class="success">âœ… æœå‹™æ­£å¸¸é‹è¡Œ</span><br>æ¨¡å‹æ•¸é‡: ${data.models?.length || 0}`;
                } else {
                    output.innerHTML = `<span class="error">âŒ æœå‹™éŒ¯èª¤: ${response.status}</span>`;
                }
            } catch (error) {
                log(`âŒ é€£æ¥éŒ¯èª¤: ${error.message}`);
                output.innerHTML = `<span class="error">âŒ é€£æ¥å¤±æ•—: ${error.message}</span>`;
            }
        }
        
        async function checkModels() {
            log('ğŸ” æª¢æŸ¥å¯ç”¨æ¨¡å‹...');
            const output = document.getElementById('models-output');
            
            try {
                const response = await fetch(`${OLLAMA_URL}/api/tags`);
                const data = await response.json();
                
                if (response.ok) {
                    output.innerHTML = `<span class="success">âœ… æ¨¡å‹åˆ—è¡¨ç²å–æˆåŠŸ</span><br>`;
                    if (data.models && data.models.length > 0) {
                        data.models.forEach(model => {
                            output.innerHTML += `- ${model.name} (${model.size} bytes)<br>`;
                        });
                    } else {
                        output.innerHTML += 'æ²’æœ‰å¯ç”¨çš„æ¨¡å‹';
                    }
                } else {
                    output.innerHTML = `<span class="error">âŒ ç²å–æ¨¡å‹åˆ—è¡¨å¤±æ•—</span>`;
                }
            } catch (error) {
                log(`âŒ æª¢æŸ¥æ¨¡å‹éŒ¯èª¤: ${error.message}`);
                output.innerHTML = `<span class="error">âŒ æª¢æŸ¥å¤±æ•—: ${error.message}</span>`;
            }
        }
        
        async function testSimpleChat() {
            log('ğŸ” æ¸¬è©¦ç°¡å–®å°è©±...');
            const output = document.getElementById('chat-output');
            
            try {
                const response = await fetch(`${OLLAMA_URL}/api/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        model: 'llama2:7b',
                        prompt: 'ä½ å¥½ï¼Œè«‹ç°¡å–®ä»‹ç´¹ä¸€ä¸‹å°åŒ—',
                        stream: false
                    })
                });
                
                log(`âœ… å°è©±éŸ¿æ‡‰: ${response.status} ${response.statusText}`);
                
                if (response.ok) {
                    const data = await response.json();
                    output.innerHTML = `<span class="success">âœ… å°è©±æˆåŠŸ</span><br>å›æ‡‰: ${data.response || 'ç„¡å›æ‡‰'}`;
                } else {
                    const errorText = await response.text();
                    log(`âŒ å°è©±éŒ¯èª¤: ${errorText}`);
                    output.innerHTML = `<span class="error">âŒ å°è©±å¤±æ•—: ${response.status}</span>`;
                }
            } catch (error) {
                log(`âŒ å°è©±éŒ¯èª¤: ${error.message}`);
                output.innerHTML = `<span class="error">âŒ å°è©±å¤±æ•—: ${error.message}</span>`;
            }
        }
        
        // é é¢åŠ è¼‰æ™‚è‡ªå‹•æª¢æŸ¥ç‹€æ…‹
        window.onload = function() {
            log('ğŸš€ é é¢åŠ è¼‰å®Œæˆï¼Œé–‹å§‹æ¸¬è©¦...');
            checkOllamaStatus();
        };
    </script>
</body>
</html>
